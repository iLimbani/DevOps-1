pipeline {
	agent none  stages {
  	stage('Maven Install') {
    	agent {
      	docker {
        	image 'maven:3.5.0'
        }
      }
      steps {
      	sh 'mvn clean install'
      }
    }
     
    stage('Build docker image') {
agent any        
steps {       
            sh 'docker build -t ilimbani/dmain .'
          }
      }

stage('push docker image to hub') {
agent any         
steps {
script{
         withCredentials([string(credentialsId: 'dockerhub-pwd', variable: 'dockerhubpwd')]) {
            sh 'docker login -u iLimbani -p ${dockerhubpwd}'
}       
sh 'docker push ilimbani/dmain'
          }
}

}
}

